import"./date-Di4mqaYl.js";let u,b,l,f,d,o;document.addEventListener("DOMContentLoaded",async()=>{v(document),o=await E(),i(o),k()});const E=async()=>{try{return await(await fetch("/shopping-list/liste_produits_quotidien.json")).json()}catch(t){return console.error("Error fetching products:",t),[]}};function v(t){u=t.getElementById("liste-produits"),b=t.getElementById("compteur-produits"),l=t.getElementById("tri"),f=t.getElementById("reset-filtres"),d=t.getElementById("recherche")}function i(t){u.innerHTML="",t.forEach(e=>{q(e)}),b.textContent=`${t.length} produits`}function k(){f.addEventListener("click",()=>{l.value="",d.value="",i(o)}),l.addEventListener("change",t=>{const e=t.target.value,n=w(o,e);i(n)}),d.addEventListener("input",t=>{const e=t.target.value.toLowerCase(),n=x(o,e);i(n)})}function w(t,e){return e==="prix"?t.sort((n,r)=>n.prix_unitaire-r.prix_unitaire):e==="nom"?t.sort((n,r)=>n.nom.localeCompare(r.nom)):t}function x(t,e){return t.filter(n=>n.nom.toLowerCase().includes(e.toLowerCase()))}function C(t){const e=window.localStorage,n=JSON.parse(e.getItem("basket"))||[],r=n.find(a=>a.nom===t.nom);return r?r.quantity+=1:n.push({nom:t.nom,price:t.prix_unitaire,quantity:1}),e.setItem("basket",JSON.stringify(n)),n}function q(t){const e=document.createElement("li");e.classList.add("bg-white","p-2","flex","flex-col","gap-2","border","border-gray-300","rounded-lg","w-full","md:w-1/5","h-52","justify-between");const n=document.createElement("h2");n.classList.add("text-lg","font-bold","text-center");const r=document.createElement("span"),a=document.createElement("span"),s=document.createElement("button");s.addEventListener("click",()=>{const L=C(t).find(y=>y.nom===t.nom);let g=t.quantite_stock-L.quantity;r.innerHTML=`<span class="font-bold">Quantité en stock</span>: ${g}`,g<=0&&(s.disabled=!0,s.classList.remove("bg-blue-500","hover:bg-blue-700"),s.classList.add("bg-gray-500"),e.classList.add("opacity-50"))}),s.textContent="Ajouter au panier",s.classList.add("bg-blue-500","text-white","p-2","rounded-lg","hover:bg-blue-700","transition-colors","duration-300","hover:cursor-pointer"),s.dataset.id=t.nom,n.innerHTML=`<span class="font-bold">${t.nom}</span>`;const h=JSON.parse(localStorage.getItem("basket"))||[];let c=t.quantite_stock;const p=h.find(m=>m.nom===t.nom);c-=p?p.quantity:0,c<=0&&(s.disabled=!0,s.classList.remove("bg-blue-500","hover:bg-blue-700","hover:cursor-pointer"),s.classList.add("bg-gray-500"),e.classList.add("opacity-50")),r.innerHTML=`<span class="font-bold">Quantité en stock</span>: ${c}`,a.innerHTML=`<span class="font-bold">Prix unitaire</span>: ${t.prix_unitaire} €`,e.appendChild(n),e.appendChild(r),e.appendChild(a),e.appendChild(s),u.appendChild(e)}
